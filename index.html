<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>White City Spin (Fixed)</title>
<style>
:root {
  --t1: #4fc3f7;
  --t15: #d32f2f;
  --t2: #ffb300;
}
body { background:#0f0f0f; color:white; font-family:Arial, Helvetica, sans-serif; margin:0; }
.spinner-viewport { position:relative; overflow:hidden; width:800px; height:200px; margin:auto; border:2px solid #222; }
.reel { display:flex; height:100%; }
.reel-item { width:160px; flex-shrink:0; display:flex; align-items:center; justify-content:center; background:#111; }
.reel-item img { max-height:120px; }
.center-line { position:absolute; top:0; bottom:0; left:50%; width:4px; background:red; z-index:5; }
.spin-btn { margin-top:20px; padding:12px 30px; font-weight:900; cursor:pointer; }
#results { display:flex; gap:15px; flex-wrap:wrap; margin-top:25px; justify-content:center; }
.result-card { background:#111; padding:10px; border:2px solid #333; text-align:center; }
.result-card img { height:80px; display:block; margin:auto; }
</style>
</head>
<body>

<h2 style="text-align:center">White City Spin (FIXED)</h2>

<select id="spin-tier" style="display:block;margin:20px auto;">
  <option value="test">Test Drop</option>
  <option value="t1">Tier 1</option>
  <option value="t15">Tier 1.5</option>
  <option value="t2">Tier 2</option>
</select>

<div class="spinner-viewport">
  <div class="center-line"></div>
  <div id="reel" class="reel"></div>
</div>

<div style="text-align:center">
  <button class="spin-btn" onclick="runSpinner()">SPIN</button>
</div>

<h3 style="text-align:center">Results</h3>
<div id="results"></div>

<script>
const WEAPONS = {
  t1: [
    { name: "Canik", img: "https://i.postimg.cc/mD8x1hM0/ar.png", color: "var(--t1)" },
    { name: "Glock", img: "https://i.postimg.cc/85zK6L6k/special.png", color: "var(--t1)" }
  ],
  t15: [
    { name: "FNX-45", img: "https://i.postimg.cc/mD8x1hM0/ar.png", color: "var(--t15)" }
  ],
  t2: [
    { name: "AR", img: "https://i.postimg.cc/mD8x1hM0/ar.png", color: "var(--t2)" }
  ]
};

function getSpinCount(tier) {
  if (tier === 'test') return 2;
  if (tier === 't2') return 6;
  return 4;
}

function getPool(tier) {
  if (tier === 'test') return WEAPONS.t1;
  return WEAPONS[tier];
}

function runSpinner() {
  const tier = document.getElementById('spin-tier').value;
  const reel = document.getElementById('reel');
  const resultsBox = document.getElementById('results');
  resultsBox.innerHTML = '';

  const pool = getPool(tier);
  const count = getSpinCount(tier);
  const wins = [];

  for (let i = 0; i < count; i++) {
    wins.push(pool[Math.floor(Math.random() * pool.length)]);
  }

  reel.innerHTML = '';

  const filler = [];
  for (let i = 0; i < 25; i++) {
    filler.push(pool[Math.floor(Math.random() * pool.length)]);
  }

  const finalIndex = 20;
  filler[finalIndex] = wins[0];

  filler.forEach(item => {
    const div = document.createElement('div');
    div.className = 'reel-item';
    div.style.borderBottom = `4px solid ${item.color}`;
    div.innerHTML = `<img src="${item.img}">`;
    reel.appendChild(div);
  });

  reel.style.transition = 'none';
  reel.style.transform = 'translateX(0)';

  requestAnimationFrame(() => {
    const itemWidth = 160;
    const offset = finalIndex * itemWidth - (400 - itemWidth / 2);
    reel.style.transition = 'transform 6s cubic-bezier(0.15, 0, 0.1, 1)';
    reel.style.transform = `translateX(-${offset}px)`;
  });

  setTimeout(() => {
    wins.forEach(w => {
      const card = document.createElement('div');
      card.className = 'result-card';
      card.innerHTML = `<img src="${w.img}"><strong>${w.name}</strong>`;
      resultsBox.appendChild(card);
    });
  }, 6200);
}
</script>

</body>
</html>
