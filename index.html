<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>White City Spin</title>

<style>
:root{
    --primary:#ff2a3b;
    --t1:#3b82f6;
    --t15:#facc15;
    --t2:#ef4444;
}
body{
    margin:0;
    background:#0b0b0b;
    font-family:Arial,Helvetica,sans-serif;
    color:white;
}
.sidebar{
    width:240px;
    background:#0f0f0f;
    height:100vh;
    position:fixed;
    left:0;
    top:0;
    border-right:1px solid #1a1a1a;
}
.logo-area{
    padding:25px;
    text-align:center;
}
.sidebar-nav{
    display:flex;
    flex-direction:column;
}
.nav-btn{
    background:none;
    border:none;
    color:white;
    padding:18px;
    font-weight:800;
    cursor:pointer;
}
.nav-btn.active{
    background:#151515;
}
.dashboard{
    margin-left:240px;
    padding:40px;
}
.section-title{
    font-size:1.8rem;
    margin-bottom:25px;
}
.grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
    gap:22px;
}
.card{
    background:#111;
    padding:18px;
    text-align:center;
    position:relative;
}
.tier-tag{
    position:absolute;
    top:10px;
    left:10px;
    padding:4px 10px;
    font-weight:900;
    font-size:.7rem;
}
.card img{
    max-height:120px;
}
.spinner-viewport{
    position:relative;
    overflow:hidden;
    height:180px;
    background:#111;
    border:1px solid #222;
}
.center-line{
    position:absolute;
    top:0;
    bottom:0;
    left:50%;
    width:4px;
    background:var(--primary);
    box-shadow:0 0 25px var(--primary);
    z-index:10;
}
.reel{
    display:flex;
    height:100%;
}
.reel-item{
    width:195px;
    flex-shrink:0;
    display:flex;
    align-items:center;
    justify-content:center;
    background:#111;
}
.reel-item img{max-height:150px}
.spin-wrap{
    display:flex;
    justify-content:center;
    margin-top:30px;
}
.spin-btn{
    background:linear-gradient(135deg,#ff2a3b,#c30012);
    border:none;
    color:white;
    padding:18px 56px;
    font-weight:900;
    font-size:1.15rem;
    cursor:pointer;
}
#spin-results{
    display:flex;
    justify-content:center;
    gap:22px;
    margin-top:35px;
    flex-wrap:wrap;
}
#spin-results img{height:95px}
</style>
</head>

<body>

<div class="sidebar">
    <div class="logo-area">
        <h1>WHITE CITY</h1>
        <p style="opacity:.6;font-size:.7rem;font-weight:900">V1.0 SYSTEM</p>
    </div>
    <div class="sidebar-nav">
        <button class="nav-btn active" onclick="nav('weapons')">White City Storage</button>
        <button class="nav-btn" onclick="nav('lucky')">Randomize</button>
    </div>
</div>

<div class="dashboard">

<div id="sec-weapons">
    <h2 class="section-title">Inventory Data</h2>

    <h3 style="color:var(--t1)">Tier 1</h3>
    <div class="grid" id="grid-t1"></div>

    <h3 style="color:var(--t15);margin-top:60px">Tier 1.5</h3>
    <div class="grid" id="grid-t15"></div>

    <h3 style="color:var(--t2);margin-top:60px">Tier 2</h3>
    <div class="grid" id="grid-t2"></div>
</div>

<div id="sec-lucky" style="display:none">
    <h2 class="section-title">Simulate a faction drop spin</h2>

    <select id="spin-tier">
        <option value="all">Test Drop</option>
        <option value="t1">Tier 1</option>
        <option value="t15">Tier 1.5</option>
        <option value="t2">Tier 2</option>
    </select>

    <div class="spinner-viewport">
        <div class="center-line"></div>
        <div id="reel" class="reel"></div>
    </div>

    <div class="spin-wrap">
        <button class="spin-btn" onclick="runSpinner()">SPIN</button>
    </div>

    <div id="spin-results"></div>
</div>

</div>

<script>
const WEAPONS={
    t1:[
        {name:'Canik',img:'',color:'var(--t1)'},
        {name:'Glock 17',img:'',color:'var(--t1)'}
    ],
    t15:[
        {name:'Black Draco',img:'',color:'var(--t15)'},
        {name:'AKM',img:'',color:'var(--t15)'}
    ],
    t2:[
        {name:'Red AK',img:'',color:'var(--t2)'},
        {name:'Scar-H',img:'',color:'var(--t2)'}
    ]
};

/* ===== PERCENT / LUCK LIST ===== */
const WEAPON_LUCK={
    "Black Draco":1,   // 1% chance
    "Red AK":4,
    "Scar-H":8
};

/* ===== WEIGHTED PICK ===== */
function weightedPick(pool){
    let total=0;
    pool.forEach(w=>total+=(WEAPON_LUCK[w.name]??100));
    let roll=Math.random()*total;
    for(const w of pool){
        roll-=(WEAPON_LUCK[w.name]??100);
        if(roll<=0)return w;
    }
    return pool[pool.length-1];
}

function nav(id){
    document.getElementById('sec-weapons').style.display=id==='weapons'?'block':'none';
    document.getElementById('sec-lucky').style.display=id==='lucky'?'block':'none';
    document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
    event.target.classList.add('active');
}

function populate(){
    ['t1','t15','t2'].forEach(t=>{
        const g=document.getElementById('grid-'+t);
        WEAPONS[t].forEach(w=>{
            g.innerHTML+=`
            <div class="card">
                <div class="tier-tag" style="background:${w.color}">${t}</div>
                <img src="${w.img}">
                <div style="font-weight:900">${w.name}</div>
            </div>`;
        });
    });
}

function getConfig(t){
    if(t==='all')return{spins:2,pool:WEAPONS.t1};
    if(t==='t1')return{spins:4,pool:WEAPONS.t1};
    if(t==='t15')return{spins:4,pool:WEAPONS.t15};
    if(t==='t2')return{spins:6,pool:WEAPONS.t2};
}

function spinOnce(pool,done){
    const reel=document.getElementById('reel');
    reel.innerHTML='';
    reel.style.transition='none';
    reel.style.transform='translateX(0)';

    const items=[];
    for(let i=0;i<35;i++)items.push(weightedPick(pool));

    const winIndex=26;
    const winner=weightedPick(pool);
    items[winIndex]=winner;

    items.forEach(i=>{
        reel.innerHTML+=`
        <div class="reel-item" style="border-bottom:4px solid ${i.color}">
            <img src="${i.img}">
        </div>`;
    });

    requestAnimationFrame(()=>{
        const w=195;
        const target=winIndex*w-(reel.parentElement.offsetWidth/2-w/2);
        reel.style.transition='transform 0.85s linear';
        reel.style.transform=`translateX(-${target-600}px)`;
        setTimeout(()=>{
            reel.style.transition='transform 0.35s cubic-bezier(0.2,0.9,0.35,1)';
            reel.style.transform=`translateX(-${target}px)`;
        },850);
    });

    setTimeout(()=>done(winner),1300);
}

function runSpinner(){
    const tier=document.getElementById('spin-tier').value;
    const {spins,pool}=getConfig(tier);
    const box=document.getElementById('spin-results');
    box.innerHTML='';
    let c=0;
    function next(){
        spinOnce(pool,w=>{
            box.innerHTML+=`
            <div>
                <img src="${w.img}">
                <div style="font-weight:900">${w.name}</div>
            </div>`;
            c++;
            if(c<spins)setTimeout(next,300);
        });
    }
    next();
}

window.onload=populate;
</script>

</body>
</html>
